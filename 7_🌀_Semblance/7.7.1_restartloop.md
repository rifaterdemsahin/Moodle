The output shows that you successfully connected to the MySQL database container (moodle_db) using the credentials moodle/moodle and the database moodle. This confirms that:
The database is running and accessible.
The credentials match between your docker-compose.yml and the database.
Network connectivity between containers (via moodle_network) is working, despite the -hdb flag being unnecessary in this context (since you’re already inside the moodle_db container).
However, the moodle_app container is still restarting, as shown in your previous output (Restarting (1) 5 seconds ago). Since the database connection is fine, the issue likely lies within the Moodle container itself—possibly in the installation script or its environment.
Next Steps to Resolve the Restart Loop
1. Check Moodle Container Exit Code
Since the container is restarting, let’s confirm why it’s exiting:
bash
docker inspect 28cdb78c2be8 --format='{{.State.ExitCode}}'
This will return a number (e.g., 1 for a general error). Share the result.
2. Run Moodle Interactively
The logs stop at Running Moodle install script, so let’s run it manually to catch the error:
Stop the restarting container:
bash
docker-compose stop moodle_app
Start it in interactive mode:
bash
docker-compose run --rm moodle_app bash
Inside the container, run the entrypoint script:
bash
/opt/bitnami/scripts/moodle/entrypoint.sh /opt/bitnami/scripts/moodle/run.sh
Watch for any errors after Running Moodle install script. This should give us the exact failure point.
3. Enable More Debugging
Your current docker-compose.yml includes MOODLE_DEBUG=yes, which should help. If you haven’t restarted with this yet, do so:
bash
docker-compose down -v  # Remove volumes to start fresh
docker-compose up -d
docker-compose logs -f moodle_app
Look for any additional debug output after Running Moodle install script.
4. Check File System Permissions
The restart could be due to volume permission issues. Inspect the mounted volumes:
bash
docker inspect 28cdb78c2be8 --format='{{json .Mounts}}'
Ensure the paths /bitnami/moodle and /bitnami/moodledata are writable. If you’re in a Codespaces-like environment, permissions might be restricted. You can test by removing the volumes temporarily:
yaml
# In docker-compose.yml, comment out these lines under moodle service
# volumes:
#   - moodle_data:/bitnami/moodle
#   - moodledata_data:/bitnami/moodledata
Then:
bash
docker-compose down -v
docker-compose up -d
5. Test a Different Moodle Version
The bitnami/moodle:4.3.3 image might have a bug. Try an earlier stable version like 4.2.2:
yaml
image: bitnami/moodle:4.2.2
bash
docker-compose down -v
docker-compose up -d
docker-compose logs -f
Current Hypothesis
Installation Script Failure: The script might be crashing due to a timeout, missing dependency, or environment issue not logged in the default output.
Volume Issue: Persistent data in the volumes might be causing a conflict, or permissions might be preventing writes.
Image Bug: The specific version (4.3.3) could have an issue with your setup.
What to Share Next
Please run the steps above (especially the interactive run or updated logs with MOODLE_DEBUG=yes) and share:
The exit code from docker inspect.
Any new error messages or logs after Running Moodle install script.
The result of the interactive run or version change.
With this info, we’ll pinpoint the exact cause and get Moodle running stably!